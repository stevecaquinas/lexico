<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Lexico Word Game</title>
</head>
<body>
<div id="game">
    <h2>LEXICO</h2>
    <div class="attempt" id="attempt"></div>
    <div class="definition" id="definition"></div>
    <input type="text" id="guess" placeholder="Enter word or 'H' for hint">
    <button id="submitBtn" onclick="submitGuess()">Submit</button>
    <div class="score" id="score"></div>
    <div id="message"></div>
    <button onclick="restartGame()">Restart</button>
</div>
<script>
let words = {};
let currentWord, currentDef, attempt, score, gameOver;

function parseStrangeWords(text) {
    const out = {};
    text.trim().split('\n').forEach(line => {
        const [word, ...def] = line.split(',');
        if(word && def.length) out[word.trim()] = def.join(',').trim();
    });
    return out;
}

function pickRandomWord() {
    const keys = Object.keys(words);
    const idx = Math.floor(Math.random() * keys.length);
    currentWord = keys[idx].toLowerCase();
    currentDef = words[keys[idx]];
    attempt = Array(currentWord.length).fill('_');
    score = 100;
    gameOver = false;
}

function updateDisplay() {
    document.getElementById('attempt').textContent = attempt.join(' ');
    document.getElementById('definition').textContent = "Definition: " + currentDef;
    document.getElementById('score').textContent = "Score: " + Math.round(score) + "%";
    document.getElementById('guess').disabled = gameOver;
    document.getElementById('submitBtn').disabled = gameOver;
}

function submitGuess() {
    if (gameOver) return;
    const guess = document.getElementById('guess').value.trim().toLowerCase();
    if (!guess) return;
    if (guess === currentWord) {
        document.getElementById('message').textContent = `CORRECT! You scored ${Math.round(score)}%`;
        gameOver = true;
        endGame();
    } else if (guess === 'h') {
        giveHint();
        checkBlanks();
    } else {
        document.getElementById('message').textContent = "Try again!";
    }
    updateDisplay();
    document.getElementById('guess').value = '';
}

function giveHint() {
    score *= 0.9;
    const unrevealed = [];
    for (let i = 0; i < currentWord.length; i++) {
        if (attempt[i] === '_') unrevealed.push(i);
    }
    if (unrevealed.length > 0) {
        const idx = unrevealed[Math.floor(Math.random() * unrevealed.length)];
        attempt[idx] = currentWord[idx];
    }
}

function checkBlanks() {
    if (!attempt.includes('_')) {
        document.getElementById('message').textContent = "You lose! The word was: " + currentWord;
        score = 0;
        gameOver = true;
        endGame();
    }
}

function endGame() {
    document.getElementById('guess').disabled = true;
    document.getElementById('submitBtn').disabled = true;
}

function restartGame() {
    pickRandomWord();
    updateDisplay();
    document.getElementById('guess').value = '';
    document.getElementById('message').textContent = '';
}

fetch('strangewords.txt')
    .then(response => response.text())
    .then(text => {
        words = parseStrangeWords(text);
        pickRandomWord();
        updateDisplay();
    })
    .catch(err => {
        document.getElementById('game').textContent = "Failed to load word list.";
    });
</script>
</body>
</html>
